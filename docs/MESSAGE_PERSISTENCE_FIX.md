# å†å²æ¶ˆæ¯é—®é¢˜è¯Šæ–­ä¸ä¿®å¤

## ğŸ” é—®é¢˜è¯Šæ–­ç»“æœ

é€šè¿‡æ£€æŸ¥å‘ç°äº†å†å²æ¶ˆæ¯åŠŸèƒ½çš„æ ¹æœ¬é—®é¢˜ï¼š

### ğŸ“‚ æ•°æ®åº“ä½ç½®
âœ… **æ‰¾åˆ°æ•°æ®åº“**: `/Users/kei/Library/Application Support/ChatRoom System/ChatRoom/chatroom.db`

### ğŸ“Š æ•°æ®åº“çŠ¶æ€
- âœ… ç”¨æˆ·æ•°æ®å­˜åœ¨ï¼ˆç”¨æˆ· kei å·²æ³¨å†Œï¼‰
- âœ… ç”¨æˆ·æƒé™æ­£ç¡®è®¾ç½®
- âŒ **æ¶ˆæ¯è¡¨ä¸ºç©ºï¼ˆ0æ¡æ¶ˆæ¯ï¼‰**

## ğŸ› æ ¹æœ¬åŸå› 

**æ¶ˆæ¯æ²¡æœ‰ä¿å­˜åˆ°æ•°æ®åº“ï¼**

åŸå› åˆ†æï¼š
1. **æœåŠ¡å™¨ä¾èµ–é—®é¢˜** - åªæœ‰é€šè¿‡æœåŠ¡å™¨å‘é€çš„æ¶ˆæ¯æ‰ä¼šä¿å­˜åˆ°æ•°æ®åº“
2. **å¦‚æœç”¨æˆ·æ²¡æœ‰å¯åŠ¨æœåŠ¡å™¨** - æ¶ˆæ¯åªåœ¨æœ¬åœ°æ˜¾ç¤ºï¼Œä¸ä¼šæŒä¹…åŒ–
3. **ç¦»çº¿æ¨¡å¼ç¼ºé™·** - ç¦»çº¿å‘é€çš„æ¶ˆæ¯ä¸ä¼šä¿å­˜

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. **ä¿®æ”¹æ¶ˆæ¯å‘é€é€»è¾‘**
æ— è®ºæœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ï¼Œéƒ½è¦ä¿å­˜æ¶ˆæ¯åˆ°æ•°æ®åº“ï¼š

```cpp
void MainWindow::onSendMessage()
{
    // è·å–æ¶ˆæ¯å†…å®¹
    QString message = m_messageInput->text().trimmed();
    QString receiver = m_recipientCombo->currentData().toString();
    QDateTime timestamp = QDateTime::currentDateTime();
    
    // è¿‡æ»¤æ•æ„Ÿè¯
    QString filteredMessage = MessageFilter::instance().filterMessage(message);
    
    if (m_client) {
        // å‘é€åˆ°æœåŠ¡å™¨
        m_client->sendMessage(filteredMessage, receiver);
        // æœ¬åœ°æ˜¾ç¤º
        addMessageToChat(m_username, filteredMessage, receiver, timestamp.toString(Qt::ISODate));
        // ğŸ’¾ ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆå…³é”®ä¿®å¤ï¼‰
        Database::instance().saveMessage(m_username, receiver, filteredMessage, timestamp);
    } else {
        // ç¦»çº¿æ¨¡å¼ä¹Ÿä¿å­˜åˆ°æ•°æ®åº“
        addMessageToChat(m_username + " (ç¦»çº¿)", filteredMessage, receiver, timestamp.toString(Qt::ISODate));
        Database::instance().saveMessage(m_username, receiver, filteredMessage, timestamp);
    }
}
```

### 2. **æ·»åŠ æ•æ„Ÿè¯è¿‡æ»¤**
åœ¨å®¢æˆ·ç«¯ä¹Ÿè¿›è¡Œæ•æ„Ÿè¯è¿‡æ»¤ï¼Œç¡®ä¿ä¸€è‡´æ€§ã€‚

### 3. **æ”¹è¿›å†å²æ¶ˆæ¯æ˜¾ç¤º**
ä½¿ç”¨å®Œæ•´çš„`ChatMessage`ç»“æ„ï¼ŒåŒ…å«æ—¶é—´æˆ³ä¿¡æ¯ã€‚

## ğŸ§ª éªŒè¯æ­¥éª¤

### 1. **é‡æ–°ç¼–è¯‘ç¨‹åº**
```bash
cd build && cmake --build . --config Release -j4
```

### 2. **æµ‹è¯•æ¶ˆæ¯ä¿å­˜**
```bash
# å¯åŠ¨ç¨‹åº
./start.sh

# å‘é€æµ‹è¯•æ¶ˆæ¯ï¼ˆä¸éœ€è¦å¯åŠ¨æœåŠ¡å™¨ï¼‰
# é€€å‡ºç¨‹åº

# æ£€æŸ¥æ•°æ®åº“
./scripts/check_database.sh
```

### 3. **éªŒè¯å†å²æ¶ˆæ¯**
```bash
# é‡æ–°å¯åŠ¨ç¨‹åº
./start.sh

# ç™»å½•åŒä¸€ç”¨æˆ·
# åº”è¯¥çœ‹åˆ°å†å²æ¶ˆæ¯
```

## ğŸ“‹ ç°åœ¨çš„å·¥ä½œæµç¨‹

### **æ¶ˆæ¯å‘é€** (æ— è®ºæœåŠ¡å™¨çŠ¶æ€)
1. ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
2. å®¢æˆ·ç«¯è¿‡æ»¤æ•æ„Ÿè¯
3. **ç«‹å³ä¿å­˜åˆ°æ•°æ®åº“** â­
4. æ˜¾ç¤ºåœ¨èŠå¤©ç•Œé¢
5. å¦‚æœæœåŠ¡å™¨åœ¨çº¿ï¼Œå‘é€ç»™å…¶ä»–ç”¨æˆ·

### **å†å²æ¶ˆæ¯åŠ è½½**
1. ç”¨æˆ·ç™»å½•
2. æŸ¥è¯¢æ•°æ®åº“è·å–æœ€è¿‘3å¤©æ¶ˆæ¯
3. æ˜¾ç¤ºå®Œæ•´çš„å†å²è®°å½•ï¼ˆåŒ…å«æ­£ç¡®æ—¶é—´æˆ³ï¼‰

## ğŸ¯ ä¿®å¤æ•ˆæœ

âœ… **ç¦»çº¿ä¹Ÿèƒ½ä¿å­˜æ¶ˆæ¯**  
âœ… **é‡æ–°ç™»å½•åèƒ½çœ‹åˆ°å†å²æ¶ˆæ¯**  
âœ… **æ¶ˆæ¯æ—¶é—´æˆ³æ­£ç¡®**  
âœ… **æ”¯æŒæ•æ„Ÿè¯è¿‡æ»¤**  
âœ… **æœåŠ¡å™¨åœ¨çº¿æ—¶ä»ç„¶æ­£å¸¸å·¥ä½œ**  

ç°åœ¨é‡æ–°æµ‹è¯•ï¼Œåº”è¯¥èƒ½æ­£å¸¸çœ‹åˆ°å†å²æ¶ˆæ¯äº†ï¼
